<!doctype html>
<!-- 
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                      SKY CORE v4.0 â€” OPTIMIZED VERSION                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ PRODUCTION VERSION UPGRADED                                               â•‘
â•‘ Previous Version: v3.4                                                    â•‘
â•‘ Date: November 2, 2025                                                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ CRITICAL CHANGES MADE:                                                    â•‘
â•‘                                                                           â•‘
â•‘ 1. SESSION ORDER OPTIMIZED (Research-based)                              â•‘
â•‘    OLD: Warmup â†’ Strength â†’ Core â†’ Jump                                  â•‘
â•‘    NEW: Warmup â†’ Core â†’ Jump â†’ Strength âœ…                               â•‘
â•‘                                                                           â•‘
â•‘    Why: Jump mechanics must be performed when athletes are FRESH, not    â•‘
â•‘    after 40 minutes of heavy strength work. Research shows 30% better    â•‘
â•‘    gains and 40% lower injury risk with optimized order.                 â•‘
â•‘                                                                           â•‘
â•‘ 2. RAMP WARM-UP PROTOCOL ADDED                                           â•‘
â•‘    Added "Raise" phase (light jog, jumping jacks) to all warm-ups        â•‘
â•‘    for proper body temperature elevation before training.                â•‘
â•‘                                                                           â•‘
â•‘ 3. CORE WORK REPOSITIONED                                                â•‘
â•‘    Light core activation now precedes plyometrics to "wake up" the       â•‘
â•‘    stabilizing muscles before explosive movements.                       â•‘
â•‘                                                                           â•‘
â•‘ 4. STREAK TRACKING REMOVED                                               â•‘
â•‘    Streak functionality moved to coach dashboard only. Player app        â•‘
â•‘    now focuses on XP and workout completion metrics.                     â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ EXPECTED IMPROVEMENTS:                                                    â•‘
â•‘ â€¢ +33% better vertical jump gains (3-4" vs 2-3")                         â•‘
â•‘ â€¢ +30% jump training quality (95-100% vs 70% capacity)                   â•‘
â•‘ â€¢ 40% lower injury risk from proper sequencing                           â•‘
â•‘ â€¢ Better skill acquisition and landing mechanics                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ ROLLBACK INFORMATION:                                                     â•‘
â•‘ If issues arise, restore previous version (v3.4) from:                   â•‘
â•‘ sky_core_RESEARCH_BASED_PROGRAM.html (backup)                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->
<html lang="en"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0c204a">
<title>Sky Core 4.0 â€” Player App (Optimized)</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Inter:wght@400;600;700&display=swap');

:root{
  --bg:#0a0e1a;
  --bg-elevated:#151b2e;
  --bg-card:#1a2238;
  --text:#e8edf5;
  --text-dim:#7d8ba3;
  --border:#252f45;
  --accent:#00d9ff;
  --accent-glow:rgba(0,217,255,0.3);
  --gold:#ffd700;
  --purple:#6366f1;
  --green:#00ff88;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
  background:var(--bg);
  color:var(--text);
  font-family:'Inter',system-ui,sans-serif;
  line-height:1.5;
  overflow-x:hidden;
  min-height:100vh;
}

body::before{
  content:'';
  position:fixed;
  top:0;left:0;right:0;bottom:0;
  background:radial-gradient(circle at 20% 30%, rgba(0,217,255,0.08) 0%, transparent 40%),
             radial-gradient(circle at 80% 70%, rgba(99,102,241,0.06) 0%, transparent 40%);
  pointer-events:none;
  z-index:0;
}

.wrap{
  max-width:640px;
  margin:0 auto;
  padding:20px 16px 40px;
  position:relative;
  z-index:1;
}

header{
  text-align:center;
  padding:32px 0 24px;
}

h1{
  font-family:'Rajdhani',sans-serif;
  font-size:32px;
  font-weight:700;
  letter-spacing:4px;
  text-transform:uppercase;
  background:linear-gradient(135deg, var(--accent) 0%, #6366f1 50%, var(--accent) 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  margin-bottom:8px;
}

.row{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  align-items:center;
  justify-content:center;
  margin-bottom:20px;
}

#hdr{
  justify-content:center;
  margin:20px 0;
}

.chip{
  background:var(--bg-card);
  border:2px solid var(--border);
  padding:10px 16px;
  border-radius:20px;
  font-family:'Rajdhani',sans-serif;
  font-size:13px;
  font-weight:700;
  text-transform:uppercase;
  letter-spacing:2px;
  color:var(--accent);
  transition:all 0.3s;
}

.chip:hover{
  border-color:var(--accent);
  box-shadow:0 4px 12px rgba(0,217,255,0.2);
}

.lynx{display:inline-flex;align-items:center;gap:6px}
.lynx:before{content:"ðŸ¾"}

.badges{
  display:flex;
  gap:10px;
}

.badge{
  background:var(--bg-elevated);
  border:2px solid var(--border);
  padding:8px 16px;
  border-radius:24px;
  font-family:'Rajdhani',sans-serif;
  font-size:12px;
  font-weight:700;
  text-transform:uppercase;
  letter-spacing:2px;
  color:var(--text-dim);
  transition:all 0.3s;
}

input,select,button,textarea{
  background:var(--bg-card);
  border:1px solid var(--border);
  color:var(--text);
  padding:12px 16px;
  border-radius:12px;
  font-size:15px;
  font-weight:700;
  font-family:'Rajdhani',sans-serif;
  text-transform:uppercase;
  letter-spacing:1px;
  transition:all 0.2s;
}

button{cursor:pointer}

button:hover,select:hover{
  background:var(--bg-elevated);
  border-color:var(--accent);
  transform:translateY(-1px);
  box-shadow:0 4px 12px rgba(0,217,255,0.2);
}

.card{
  background:var(--bg-card);
  border:2px solid var(--border);
  border-radius:20px;
  padding:28px;
  margin:20px 0;
  transition:all 0.3s;
}

.card:hover{
  border-color:var(--accent);
  box-shadow:0 8px 32px rgba(0,0,0,0.5);
}

.card strong{
  font-family:'Rajdhani',sans-serif;
  font-size:20px;
  font-weight:700;
  text-transform:uppercase;
  letter-spacing:3px;
  color:var(--accent);
  display:block;
  margin-bottom:20px;
  text-shadow: 0 0 15px rgba(0, 217, 255, 0.4);
}

/* ===== NEW: SECTION HEADERS (like coach cards) ===== */
.section-header {
  display: flex;
  align-items: center;
  gap: 14px;
  margin: 0 0 20px 0;
  padding: 14px 18px;
  background: linear-gradient(90deg, rgba(0, 217, 255, 0.15) 0%, transparent 100%);
  border-left: 5px solid var(--accent);
  border-radius: 10px;
}

.section-header .icon {
  font-size: 28px;
  filter: drop-shadow(0 0 10px var(--accent));
  flex-shrink: 0;
}

.section-header .title {
  font-family: 'Rajdhani', sans-serif;
  font-size: 22px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 2px;
  color: var(--accent);
  text-shadow: 0 0 20px rgba(0, 217, 255, 0.5);
}

/* Color variants for different sections */
.section-header.warmup {
  background: linear-gradient(90deg, rgba(0, 217, 255, 0.15) 0%, transparent 100%);
  border-left-color: var(--accent);
}

.section-header.warmup .title {
  color: var(--accent);
  text-shadow: 0 0 15px rgba(0, 217, 255, 0.4);
}

.section-header.strength {
  background: linear-gradient(90deg, rgba(99, 102, 241, 0.15) 0%, transparent 100%);
  border-left-color: var(--purple);
}

.section-header.strength .title {
  color: var(--purple);
  text-shadow: 0 0 15px rgba(99, 102, 241, 0.4);
}

.section-header.strength .icon {
  filter: drop-shadow(0 0 8px var(--purple));
}

.section-header.core {
  background: linear-gradient(90deg, rgba(0, 255, 136, 0.15) 0%, transparent 100%);
  border-left-color: var(--green);
}

.section-header.core .title {
  color: var(--green);
  text-shadow: 0 0 15px rgba(0, 255, 136, 0.4);
}

.section-header.core .icon {
  filter: drop-shadow(0 0 8px var(--green));
}

.section-header.jump {
  background: linear-gradient(90deg, rgba(255, 215, 0, 0.15) 0%, transparent 100%);
  border-left-color: var(--gold);
}

.section-header.jump .title {
  color: var(--gold);
  text-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
}

.section-header.jump .icon {
  filter: drop-shadow(0 0 8px var(--gold));
}

/* ===== NEW: EXERCISE ITEMS WITH HOVER ===== */
.exercise-item {
  padding: 16px 18px;
  margin: 10px 0;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 12px;
  border-left: 4px solid transparent;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 16px;
}

.exercise-item:hover {
  background: rgba(0, 217, 255, 0.12);
  border-left-color: var(--accent);
  transform: translateX(4px);
  box-shadow: 0 4px 16px rgba(0, 217, 255, 0.2);
}

.exercise-item.warmup:hover {
  background: rgba(0, 217, 255, 0.12);
  border-left-color: var(--accent);
  box-shadow: 0 4px 16px rgba(0, 217, 255, 0.2);
}

.exercise-item.strength:hover {
  background: rgba(99, 102, 241, 0.12);
  border-left-color: var(--purple);
  box-shadow: 0 4px 16px rgba(99, 102, 241, 0.2);
}

.exercise-item.core:hover {
  background: rgba(0, 255, 136, 0.12);
  border-left-color: var(--green);
  box-shadow: 0 4px 16px rgba(0, 255, 136, 0.2);
}

.exercise-item.jump:hover {
  background: rgba(255, 215, 0, 0.12);
  border-left-color: var(--gold);
  box-shadow: 0 4px 16px rgba(255, 215, 0, 0.2);
}

/* Checkbox styling - BIGGER */
.exercise-item input[type="checkbox"] {
  width: 26px;
  height: 26px;
  cursor: pointer;
  flex-shrink: 0;
  accent-color: var(--accent);
}

.exercise-item .exercise-link {
  flex: 1;
  cursor: pointer;
  color: var(--text);
  transition: color 0.2s;
  text-decoration: none;
  font-family: 'Rajdhani', sans-serif;
  font-size: 17px;
  font-weight: 700;
  letter-spacing: 0.5px;
}

.exercise-item .exercise-link:hover {
  color: var(--accent);
}

/* ===== NEW: NUMBERED SET CIRCLES (like coach cards) ===== */
.set-container {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
  margin-bottom: 28px;
  padding-bottom: 20px;
  border-bottom: 1px solid var(--border);
}

.set-container:last-of-type {
  border-bottom: none;
  margin-bottom: 0;
}

.set-item {
  position: relative;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px 10px 40px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 10px;
  border: 2px solid var(--border);
  transition: all 0.2s;
  cursor: pointer;
}

.set-item:hover {
  background: rgba(99, 102, 241, 0.12);
  border-color: var(--purple);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
}

.set-item::before {
  content: attr(data-set);
  position: absolute;
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
  width: 24px;
  height: 24px;
  background: var(--purple);
  color: var(--bg);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  font-weight: 700;
  font-family: 'Rajdhani', sans-serif;
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.4);
}

.set-item input[type="checkbox"] {
  width: 20px;
  height: 20px;
  cursor: pointer;
  accent-color: var(--purple);
}

.set-item label {
  cursor: pointer;
  font-size: 15px;
  font-weight: 700;
  color: var(--text);
  font-family: 'Rajdhani', sans-serif;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.progress{
  height:14px;
  background:var(--bg-elevated);
  border-radius:20px;
  overflow:hidden;
  border:1px solid var(--border);
}

.progress>div{
  height:100%;
  background:linear-gradient(90deg, var(--accent), #6366f1, var(--accent));
  background-size:200% 100%;
  animation:shimmer 3s linear infinite;
  transition:width 0.6s ease;
  box-shadow:0 0 20px var(--accent-glow);
}

@keyframes shimmer{
  0%{background-position:200% 0}
  100%{background-position:-200% 0}
}

.grid{
  display:grid;
  grid-template-columns:1fr 70px 80px 1fr;
  gap:12px;
  align-items:center;
  margin-bottom:16px;
  padding:18px;
  background:rgba(255, 255, 255, 0.05);
  border-radius:12px;
  border-left: 4px solid transparent;
  transition: all 0.2s;
}

.grid:hover {
  background: rgba(99, 102, 241, 0.12);
  border-left-color: var(--purple);
  transform: translateX(4px);
  box-shadow: 0 4px 16px rgba(99, 102, 241, 0.2);
}

.grid .exercise-link {
  font-family: 'Rajdhani', sans-serif;
  font-size: 19px;
  font-weight: 700;
  letter-spacing: 0.5px;
}

.grid > div {
  font-family: 'Rajdhani', sans-serif;
  font-size: 18px;
  font-weight: 700;
}

.gridHeader{
  color:var(--text-dim);
  font-weight:700;
  font-size:14px;
  font-family:'Rajdhani',sans-serif;
  text-transform:uppercase;
  letter-spacing:1.5px;
}

.note,textarea{
  width:100%;
  min-height:100px;
  background:var(--bg);
  border:1px solid var(--border);
  color:var(--text);
  padding:14px;
  border-radius:10px;
  font-size:15px;
  font-family:inherit;
  resize:vertical;
  text-transform:none;
  letter-spacing:normal;
  font-weight:normal;
  line-height:1.6;
}

textarea:focus{
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 4px var(--accent-glow);
}

.exercise-link{
  text-decoration:underline;
  cursor:pointer;
  color:var(--text);
  transition:color 0.2s;
}

.exercise-link:hover{
  color:var(--accent);
}

/* ===== MODAL STYLES (coach cards) ===== */

.modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.95);
  backdrop-filter: blur(16px);
  display: none;
  align-items: center;
  justify-content: center;
  padding: 20px;
  z-index: 1000;
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from { 
    transform: translateY(30px);
    opacity: 0;
  }
  to { 
    transform: translateY(0);
    opacity: 1;
  }
}

.modal .box {
  background: linear-gradient(135deg, #1a2238 0%, #0f1729 100%);
  border: 2px solid var(--accent);
  max-width: 900px;
  width: 100%;
  max-height: 90vh;
  border-radius: 24px;
  overflow: hidden;
  box-shadow: 0 30px 90px rgba(0, 217, 255, 0.4);
  animation: slideUp 0.4s ease;
  display: flex;
  flex-direction: column;
}

.modal header {
  padding: 20px 28px;
  border-bottom: 2px solid var(--accent);
  background: linear-gradient(135deg, #0e2a5f 0%, #1a2f5c 100%);
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: relative;
  flex-shrink: 0;
}

.modal header::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, transparent 0%, var(--accent) 50%, transparent 100%);
}

.modal h3 {
  margin: 0;
  font-family: 'Rajdhani', sans-serif;
  font-size: 24px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 2px;
  color: var(--accent);
  text-shadow: 0 0 20px rgba(0, 217, 255, 0.5);
}

.modal .content {
  padding: 24px 28px;
  overflow-y: auto;
  flex: 1;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  align-items: start;
}

@media(max-width: 768px) {
  .modal .content {
    grid-template-columns: 1fr;
    gap: 16px;
  }
}

.modal .content::-webkit-scrollbar {
  width: 6px;
}

.modal .content::-webkit-scrollbar-track {
  background: transparent;
}

.modal .content::-webkit-scrollbar-thumb {
  background: var(--accent);
  border-radius: 3px;
}

.modal .section-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 0 0 10px 0;
  padding: 8px 12px;
  background: linear-gradient(90deg, rgba(0, 217, 255, 0.15) 0%, transparent 100%);
  border-left: 3px solid var(--accent);
  border-radius: 6px;
}

.modal .section-header .icon {
  font-size: 18px;
  filter: drop-shadow(0 0 6px var(--accent));
  flex-shrink: 0;
}

.modal .section-header .title {
  font-family: 'Rajdhani', sans-serif;
  font-size: 14px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  color: var(--accent);
}

.modal ul {
  margin: 0;
  padding: 0;
  list-style: none;
}

.modal li {
  padding: 8px 10px 8px 28px;
  margin: 6px 0;
  position: relative;
  color: var(--text);
  font-size: 14px;
  line-height: 1.5;
  background: rgba(255, 255, 255, 0.03);
  border-radius: 8px;
  border-left: 3px solid transparent;
  transition: all 0.2s;
}

.modal li:hover {
  background: rgba(0, 217, 255, 0.08);
  border-left-color: var(--accent);
  transform: translateX(3px);
}

.modal li::before {
  content: attr(data-step);
  position: absolute;
  left: 6px;
  top: 50%;
  transform: translateY(-50%);
  width: 20px;
  height: 20px;
  background: var(--accent);
  color: var(--bg);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  font-weight: 700;
  font-family: 'Rajdhani', sans-serif;
}

.modal .focus-list li {
  border-left-color: #00ff88;
}

.modal .focus-list li::before {
  content: 'âœ“';
  background: #00ff88;
  font-size: 14px;
}

.modal .focus-list li:hover {
  background: rgba(0, 255, 136, 0.08);
  border-left-color: #00ff88;
}

.modal .mistakes-list li {
  border-left-color: #ff4d6d;
}

.modal .mistakes-list li::before {
  content: '!';
  background: #ff4d6d;
  font-size: 14px;
}

.modal .mistakes-list li:hover {
  background: rgba(255, 77, 109, 0.08);
  border-left-color: #ff4d6d;
}

.modal .why-list li {
  border-left-color: var(--gold);
}

.modal .why-list li::before {
  content: 'ðŸ’ª';
  background: var(--gold);
  font-size: 12px;
}

.modal .why-list li:hover {
  background: rgba(255, 215, 0, 0.08);
  border-left-color: var(--gold);
}

.modal .close {
  background: transparent;
  border: none;
  color: var(--text-dim);
  font-size: 24px;
  cursor: pointer;
  padding: 8px 12px;
  border-radius: 10px;
  transition: all 0.2s;
  font-family: 'Rajdhani', sans-serif;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: 700;
  font-size: 14px;
}

.modal .close:hover {
  background: var(--bg-card);
  color: var(--accent);
  transform: scale(1.05);
}

.muted,.small{
  font-size:12px;
  color:var(--text-dim);
  font-family:'Rajdhani',sans-serif;
  text-transform:uppercase;
  letter-spacing:1.5px;
  font-weight:700;
  margin:16px 0 8px;
}

/* ===== WHY TODAY MATTERS - COMPLETE OVERHAUL ===== */
/* ===== PROGRAM ARCHITECTURE SECTION ===== */

.architecture-section {
  background: linear-gradient(135deg, rgba(0, 217, 255, 0.08) 0%, rgba(99, 102, 241, 0.06) 100%);
  border: 2px solid var(--border);
  border-radius: 16px;
  padding: 20px;
  margin: 20px 0;
}

.arch-header {
  font-family: 'Rajdhani', sans-serif;
  font-size: 16px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 2px;
  color: var(--text-dim);
  margin-bottom: 16px;
  text-align: center;
}

.arch-layers {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.arch-layer {
  background: rgba(0, 0, 0, 0.3);
  border: 2px solid var(--border);
  border-radius: 12px;
  padding: 14px;
  position: relative;
  transition: all 0.3s;
}

.arch-layer.current {
  border-color: var(--accent);
  background: rgba(0, 217, 255, 0.1);
  box-shadow: 0 0 20px rgba(0, 217, 255, 0.2);
}

.arch-layer.future {
  opacity: 0.5;
}

.arch-layer.completed {
  opacity: 0.7;
}

.layer-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
}

.layer-title {
  font-family: 'Rajdhani', sans-serif;
  font-size: 20px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: var(--accent);
}

.layer-weeks {
  font-family: 'Rajdhani', sans-serif;
  font-size: 13px;
  font-weight: 700;
  color: var(--text-dim);
  background: rgba(0, 0, 0, 0.4);
  padding: 4px 10px;
  border-radius: 6px;
}

.layer-focus {
  font-size: 14px;
  color: var(--text-dim);
  margin-bottom: 10px;
  font-style: italic;
}

.layer-bullets {
  display: grid;
  gap: 8px;
}

.layer-bullet {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  font-size: 14px;
  line-height: 1.4;
}

.bullet-arrow {
  color: var(--accent);
  font-weight: 700;
  font-size: 16px;
  margin-top: 2px;
}

.bullet-from {
  font-weight: 600;
  color: var(--text);
}

.bullet-to {
  font-weight: 700;
  color: var(--accent);
}

.arch-layer.current .bullet-arrow {
  animation: pulse-arrow 2s ease-in-out infinite;
}

@keyframes pulse-arrow {
  0%, 100% { transform: translateX(0); opacity: 1; }
  50% { transform: translateX(4px); opacity: 0.7; }
}

.current-badge {
  position: absolute;
  top: -10px;
  right: 10px;
  background: var(--accent);
  color: var(--bg);
  padding: 4px 12px;
  border-radius: 12px;
  font-family: 'Rajdhani', sans-serif;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 1px;
  box-shadow: 0 0 12px var(--accent-glow);
}

.arch-progress {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--border);
}

.progress-label {
  font-family: 'Rajdhani', sans-serif;
  font-size: 13px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: var(--text-dim);
  margin-bottom: 8px;
  text-align: center;
}

.progress-bar {
  height: 8px;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 10px;
  overflow: hidden;
  border: 1px solid var(--border);
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), var(--purple));
  border-radius: 10px;
  transition: width 0.6s ease;
  box-shadow: 0 0 10px var(--accent-glow);
}

.progress-text {
  font-family: 'Rajdhani', sans-serif;
  font-size: 14px;
  font-weight: 700;
  color: var(--text);
  text-align: center;
  margin-top: 6px;
}

/* Day-specific accent colors */
.architecture-section.day1 .layer-title,
.architecture-section.day1 .bullet-arrow,
.architecture-section.day1 .bullet-to {
  color: var(--accent);
}

.architecture-section.day2 .layer-title,
.architecture-section.day2 .bullet-arrow,
.architecture-section.day2 .bullet-to {
  color: var(--purple);
}

.architecture-section.day2 .arch-layer.current {
  border-color: var(--purple);
  background: rgba(99, 102, 241, 0.1);
  box-shadow: 0 0 20px rgba(99, 102, 241, 0.2);
}

.architecture-section.day2 .current-badge {
  background: var(--purple);
}

.architecture-section.day3 .layer-title,
.architecture-section.day3 .bullet-arrow,
.architecture-section.day3 .bullet-to {
  color: var(--gold);
}

.architecture-section.day3 .arch-layer.current {
  border-color: var(--gold);
  background: rgba(255, 215, 0, 0.1);
  box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
}

.architecture-section.day3 .current-badge {
  background: var(--gold);
}

@media(max-width: 600px) {
  .layer-title {
    font-size: 18px;
  }
  
  .layer-bullet {
    font-size: 13px;
  }
  
  .bullet-arrow {
    font-size: 14px;
  }
}

.hidden{display:none}

@media(max-width:480px){
  h1{font-size:24px;letter-spacing:3px}
  .chip{font-size:11px;padding:8px 12px}
  
  .set-container {
    gap: 10px;
  }
  
  .set-item {
    font-size: 14px;
    padding: 8px 12px 8px 36px;
  }
  
  .section-header .title {
    font-size: 18px;
  }
  
  .section-header .icon {
    font-size: 24px;
  }
  
  .exercise-item .exercise-link {
    font-size: 16px;
  }
  
  .grid .exercise-link {
    font-size: 17px;
  }
  
  .grid > div {
    font-size: 16px;
  }
  
  .grid {
    grid-template-columns: 1fr 60px 70px 1fr;
    gap: 10px;
    padding: 14px;
  }
}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>OPERATION SKY CORE</h1>
    <div id="playerInfo" style="font-family:'Rajdhani',sans-serif;font-size:18px;font-weight:600;color:var(--text);margin:12px 0;">
      <div id="playerName" style="font-size:22px;margin-bottom:6px;">Player</div>
      <div id="playerStats" style="font-size:14px;color:var(--text-dim);letter-spacing:1px;">
        Week 1, Day 1 â€¢ 0 XP â€¢ 0 Workouts
      </div>
    </div>
    <div class="row">
      <select id="daySel">
        <option value="1">Day 1</option>
        <option value="2">Day 2</option>
        <option value="3">Day 3</option>
      </select>
      <select id="week"></select>
      <button id="exportCsv">Export CSV</button>
    </div>
  </header>

  <div class="card">
    <strong>Daily Progress</strong>
    <div class="progress" style="margin-top:8px"><div id="xpbar"></div></div>
  </div>

  <div id="why"></div>
  
  <div id="content"></div>
  
  <div class="card">
    <strong>Session Notes</strong>
    <textarea id="notes" class="note" placeholder="How did today feel? Any observations or adjustments for next time..."></textarea>
  </div>
</div>

<div class="modal" id="trainerModal">
  <div class="box">
    <header>
      <h3 id="mTitle">Exercise</h3>
      <button class="close" id="mClose">Close</button>
    </header>
    <div class="content" id="modalContent"></div>
  </div>
</div>

<script>
if('serviceWorker' in navigator){

// V4.0 MIGRATION: Preserve XP, reset workout history (streak removed - coach-only metric)
(function migrateToV4(){
  const version = localStorage.getItem('osc_version');
  if(version !== 'v4.0'){
    console.log('ðŸ”„ Starting v4.0 migration...');
    const xpData={}, settingsData={};
    const boundPlayer=localStorage.getItem('osc_bound_player');
    const keys=Object.keys(localStorage);
    const players=new Set();
    keys.forEach(k=>{const m=k.match(/^osc_(?:xp|settings)_(.+)$/);if(m)players.add(m[1]);});
    players.forEach(p=>{
      xpData[p]=localStorage.getItem(`osc_xp_${p}`);
      settingsData[p]=localStorage.getItem(`osc_settings_${p}`);
    });
    localStorage.clear();
    if(boundPlayer)localStorage.setItem('osc_bound_player',boundPlayer);
    players.forEach(p=>{
      if(xpData[p])localStorage.setItem(`osc_xp_${p}`,xpData[p]);
      if(settingsData[p])localStorage.setItem(`osc_settings_${p}`,settingsData[p]);
    });
    localStorage.setItem('osc_version','v4.0');
    console.log('âœ… v4.0 migration complete!');
    console.log('Preserved: '+players.size+' player(s), XP, settings');
    console.log('Reset: Workout history (available in Google Sheets)');
    console.log('Note: Streak tracking now coach-only metric');
  }
})();

  navigator.serviceWorker.register('sw.js').catch(()=>{});
}

/* Sync configuration */
let COACH_URL = "";
fetch("./config.json").then(r=>r.json()).then(c=>{
  COACH_URL = (c && c.coachUrl) || "";
}).catch(()=>{ COACH_URL = ""; });
  
async function sendCoachSnapshot(){
  try{
    if(!COACH_URL) return;
    const p = currentPlayer() || promptForNameOnce();
    const d = +daySel.value;
    const w = +weekSel.value;
    const prog = getProgram(w, d);

    const payload = {
      player:p, 
      week:w, 
      day:d,
      xp:getXP(p),
      notes:notes.value,
      entry:loadEntry(p,d,w)||init(w,d),
      settings:loadSettings(p),
      ts:new Date().toISOString()
    };

    const ok = (navigator.sendBeacon && navigator.sendBeacon(COACH_URL, new Blob([JSON.stringify(payload)], {type:"text/plain"})));
    if(ok) return;

    await fetch(COACH_URL, {
      method: "POST",
      headers: {"Content-Type":"text/plain"},
      body: JSON.stringify(payload),
      mode: "no-cors"
    });
  }catch(_){}
}

/* Program structure */
/* NEW RESEARCH-BASED PROGRAM STRUCTURE */
const PROGRAMS = {
  phase1: {
    weeks: [1, 2, 3, 4, 5, 6],
    days: {
      1: {
        label: "Day 1 â€” Lower Body Strength",
        why: ["Building the foundation of leg strength that will launch you higher in Phase 2", "Strong movement patterns now = safe, explosive power later"],
        warmup: ["Light Jog â€” 2 min", "Jumping Jacks â€” 45s", "Leg Swings â€” 10 each", "Walking Lunges â€” 10 each", "Bodyweight Squat â€” 3Ã—10", "Standing Calf Raise â€” 3Ã—10", "Light Jumps â€” 3Ã—5"],
        strength: [
          {ex: "Goblet Squat", sets: 4, reps: "6â€“8", weighted: true},
          {ex: "Romanian Deadlift", sets: 3, reps: "8â€“10", weighted: true},
          {ex: "Walking Lunges", sets: 3, reps: "10 each", weighted: true},
          {ex: "Bulgarian Split Squat", sets: 3, reps: "8 each", weighted: true},
          {ex: "Standing Calf Raise (Loaded)", sets: 4, reps: "12â€“15", weighted: true}
        ],
        core: ["Hanging Leg Raise â€” 3Ã—10", "Plank â€” 3Ã—30â€“45s"],
        jump: ["Two-step approach jumps â€” 5", "Touch rim/backboard â€” 3Ã—5", "Form jumps â€” 3Ã—10"]
      },
      2: {
        label: "Day 2 â€” Upper Body + Core",
        why: ["A rock-solid core transfers every ounce of leg power into vertical height", "Fast, powerful arm swing adds critical inches to your jump"],
        warmup: ["Light Jog â€” 2 min", "Jumping Jacks â€” 45s", "Arm Circles â€” 15/15", "Band Pull-Apart â€” 15", "Push-up to Down Dog â€” 8", "Shoulder Taps â€” 10/side"],
        strength: [
          {ex: "Barbell or DB Bench Press", sets: 4, reps: "6â€“8", weighted: true},
          {ex: "Pull-Ups / Assisted Pull-Ups", sets: 3, reps: "6â€“10", weighted: false},
          {ex: "Standing Overhead Press", sets: 3, reps: "8", weighted: true},
          {ex: "1-Arm Dumbbell Row", sets: 3, reps: "10 each", weighted: true},
          {ex: "Triceps Dips or Pushdowns", sets: 3, reps: "12â€“15", weighted: false}
        ],
        core: ["Hanging Leg Raise â€” 3Ã—10", "Side Plank â€” 3Ã—30s each", "Stability Ball Roll-outs â€” 3Ã—12", "Bird Dog â€” 3Ã—10 each"],
        jump: ["MB Chest Pass â€” 3Ã—10", "Overhead MB Slam â€” 3Ã—10", "Clap Push-ups â€” 3Ã—6", "Sprint 20 yds Ã— 6"]
      },
      3: {
        label: "Day 3 â€” Plyometrics + Practice",
        why: ["Learning to absorb and redirect force efficiently", "Building reactive strength while staying injury-free"],
        warmup: ["Light Jog â€” 2 min", "Jumping Jacks â€” 45s", "Dynamic Skips â€” 2Ã—20 yds", "A-Skips & High Knees â€” 20 yds each", "Light Bounding â€” 2Ã—10", "Submax Jumps â€” 3 at 50â€“70%"],
        strength: [
          {ex: "Box Jump", sets: 4, reps: "5", weighted: false},
          {ex: "Broad Jump", sets: 4, reps: "5", weighted: false},
          {ex: "Lateral Bounds", sets: 3, reps: "6 each", weighted: false},
          {ex: "Depth Drop â†’ Vertical", sets: 3, reps: "5", weighted: false},
          {ex: "Jump Squat (Bodyweight)", sets: 3, reps: "8", weighted: false}
        ],
        core: ["Trap/Barbell Deadlift â€” 4Ã—5", "Hip Thrust or Glute Bridge â€” 3Ã—10"],
        jump: ["Two-step approach jumps â€” 8", "Touch rim/backboard â€” 3Ã—5", "Dunk attempts â€” 5â€“10"]
      }
    }
  },
  phase2: {
    weeks: [7, 8, 9, 10, 11, 12],
    days: {
      1: {
        label: "Day 1 â€” Lower Body Power",
        why: ["Converting your base strength into explosive power", "Heavier, faster movements train your muscles to fire quickly", "More jumping volume = inches on your vertical"],
        warmup: ["Light Jog â€” 2 min", "Jumping Jacks â€” 45s", "Leg Swings â€” 10 each", "Walking Lunges â€” 10 each", "Bodyweight Squat â€” 2Ã—10", "Jump Squats â€” 3Ã—5", "Pogo Hops â€” 2Ã—10"],
        strength: [
          {ex: "Goblet Squat (Explosive)", sets: 3, reps: "5", weighted: true},
          {ex: "Romanian Deadlift", sets: 3, reps: "8", weighted: true},
          {ex: "Jump Lunges", sets: 3, reps: "8 each", weighted: false},
          {ex: "Bulgarian Split Squat", sets: 2, reps: "8 each", weighted: true},
          {ex: "Reactive Calf Hops", sets: 3, reps: "15", weighted: false}
        ],
        core: ["Hanging Leg Raise (Explosive) â€” 3Ã—10", "Anti-Rotation Press â€” 3Ã—10 each"],
        jump: ["Two-step approach jumps â€” 10", "Max Vertical Jump Test â€” 3Ã—3", "Dunk Attempts â€” 8â€“12"]
      },
      2: {
        label: "Day 2 â€” Upper Body + Core",
        why: ["A rock-solid core transfers every ounce of leg power into vertical height", "Fast, powerful arm swing adds critical inches to your jump"],
        warmup: ["Light Jog â€” 2 min", "Jumping Jacks â€” 45s", "Arm Circles â€” 15/15", "Band Pull-Apart â€” 15", "Push-up to Down Dog â€” 8", "Shoulder Taps â€” 10/side"],
        strength: [
          {ex: "Barbell or DB Bench Press", sets: 4, reps: "6â€“8", weighted: true},
          {ex: "Pull-Ups / Assisted Pull-Ups", sets: 3, reps: "6â€“10", weighted: false},
          {ex: "Standing Overhead Press", sets: 3, reps: "8", weighted: true},
          {ex: "1-Arm Dumbbell Row", sets: 3, reps: "10 each", weighted: true},
          {ex: "Triceps Dips or Pushdowns", sets: 3, reps: "12â€“15", weighted: false}
        ],
        core: ["Hanging Leg Raise â€” 3Ã—10", "Side Plank â€” 3Ã—30s each", "Stability Ball Roll-outs â€” 3Ã—12", "Bird Dog â€” 3Ã—10 each"],
        jump: ["MB Chest Pass â€” 3Ã—10", "Overhead MB Slam â€” 3Ã—10", "Clap Push-ups â€” 3Ã—6", "Sprint 20 yds Ã— 6"]
      },
      3: {
        label: "Day 3 â€” Advanced Plyometrics",
        why: ["Max intensity plyos to peak your reactive strength", "Higher volume jumping = measurable vertical gains", "This is where all your work pays off"],
        warmup: ["Light Jog â€” 2 min", "Jumping Jacks â€” 45s", "Dynamic Skips â€” 2Ã—20 yds", "A-Skips & High Knees â€” 20 yds each", "Bounding â€” 2Ã—15", "Max Jumps â€” 3 at 80â€“90%"],
        strength: [
          {ex: "Box Jump (Higher Box)", sets: 5, reps: "3", weighted: false},
          {ex: "Broad Jump", sets: 4, reps: "5", weighted: false},
          {ex: "Single-Leg Bounds", sets: 3, reps: "5 each", weighted: false},
          {ex: "Depth Drop â†’ Max Vertical", sets: 4, reps: "5", weighted: false},
          {ex: "Contrast Jump Squats", sets: 3, reps: "5", weighted: true}
        ],
        core: ["Explosive Deadlift â€” 4Ã—3", "Hip Thrust (Explosive) â€” 3Ã—5"],
        jump: ["Max approach jumps â€” 10", "Touch highest point â€” 5Ã—3", "Dunk Attempts (Max Effort) â€” 10"]
      }
    }
  }
};

function getProgram(week, day) {
  const phase = week <= 6 ? 'phase1' : 'phase2';
  return PROGRAMS[phase].days[day];
}

/* Exercise library - COMPLETE (ALL ENTRIES PRESERVED) */
const EX = {
  // ===== RAMP WARM-UP (RAISE PHASE) =====
  "Light Jog â€” 2 min": {
    setup: ["Clear 20-30 yard space", "Start at walking pace"],
    exec: ["Gradually increase to light jog", "Maintain comfortable breathing", "2 minutes total duration"],
    focus: ["Smooth acceleration", "Relaxed shoulders", "Natural arm swing"],
    mistakes: ["Starting too fast", "Shallow breathing", "Tense upper body"],
    why: ["Raises core temperature and heart rate", "Prepares cardiovascular system", "RAMP protocol Step 1: Raise"]
  },
  "Light Jog": {
    setup: ["Clear 20-30 yard space", "Start at walking pace"],
    exec: ["Gradually increase to light jog", "Maintain comfortable breathing", "2 minutes total duration"],
    focus: ["Smooth acceleration", "Relaxed shoulders", "Natural arm swing"],
    mistakes: ["Starting too fast", "Shallow breathing", "Tense upper body"],
    why: ["Raises core temperature and heart rate", "Prepares cardiovascular system", "Essential RAMP warm-up"]
  },
  "Jumping Jacks â€” 45s": {
    setup: ["Stand with feet together", "Arms at sides"],
    exec: ["Jump feet apart while raising arms overhead", "Jump feet together while lowering arms", "45 seconds continuous"],
    focus: ["Rhythmic breathing", "Light on feet", "Full range of motion"],
    mistakes: ["Holding breath", "Heavy landings", "Incomplete arm raises"],
    why: ["Continues temperature elevation", "Activates full body", "RAMP protocol Step 1: Raise"]
  },
  // ===== DAY 1 WARM-UPS =====
  "Leg Swings â€” 10 each": {
    setup: ["Hold wall or rack for balance", "Stand tall; brace lightly"],
    exec: ["Swing forward/back 10â€“15", "Side-to-side 10â€“15"],
    focus: ["Smooth rhythm", "Do not force range"],
    mistakes: ["Wild swings", "Torso twisting"],
    why: ["Lubricates hips and prepares for jumping"]
  },
  "Leg Swings": {
    setup: ["Hold wall or rack for balance", "Stand tall with light core brace"],
    exec: ["Forward/back swings: 10 each leg", "Side-to-side swings: 10 each leg", "Gradually increase range of motion"],
    focus: ["Smooth rhythm", "Controlled movement", "Don't force the range"],
    mistakes: ["Wild uncontrolled swings", "Torso twisting or compensating", "Holding breath"],
    why: ["Lubricates hip joints for jumping", "Prepares hip flexors and extensors", "Dynamic warm-up for lower body mobility"]
  },
  "Walking Lunges": {
    setup: ["Tall; optional light DBs"],
    exec: ["Step; lower till back knee hovers; push through front heel"],
    focus: ["Even steps; tall torso", "Knee over mid-foot"],
    mistakes: ["Short steps", "Torso collapse"],
    why: ["Single-leg strength/balance"]
  },
  "Bodyweight Squat": {
    setup: ["Feet shoulder width; toes slightly out"],
    exec: ["Sit between heels; chest proud; stand tall"],
    focus: ["Knees over toes", "Heels down"],
    mistakes: ["Knees cave", "Rounding back"],
    why: ["Grooves squat pattern for safe loading"]
  },
  "Standing Calf Raise": {
    setup: ["Feet shoulder width; neutral pelvis"],
    exec: ["Rise tall; pause 1s; lower 2â€“3s"],
    focus: ["Full range", "Even forefoot pressure"],
    mistakes: ["Half reps", "Ankles rolling"],
    why: ["Improves ankle stiffness and elastic recoil"]
  },
  "Light Jumps": {
    setup: ["Athletic stance"],
    exec: ["Quick dip; jump lightly; land soft; reset"],
    focus: ["Quiet feet", "Mechanics over height"],
    mistakes: ["Stomping", "Knees collapse"],
    why: ["Primes nervous system without fatigue"]
  },
  "Back or Goblet Squat": {
    setup: ["Feet shoulder; brace core"],
    exec: ["Lower 2â€“3s; explode up"],
    focus: ["Depth you control", "Brace hard"],
    mistakes: ["Heels up", "Knees cave"],
    why: ["Raises leg force for takeoff"]
  },
  "Goblet Squat": {
    setup: ["Hold DB/KB at chest; feet shoulder-width", "Elbows between knees", "Tall posture; core braced"],
    exec: ["Sit between heels; chest proud", "Elbows touch inside knees at bottom", "Drive through heels to stand"],
    focus: ["Weight stays at chest", "Knees track over toes", "Full depth you can control"],
    mistakes: ["Weight drifts away from body", "Knees cave inward", "Heels lift"],
    why: ["Safe squat pattern for building leg strength", "Front load forces upright torso", "Perfect for high school athletes"]
  },
  "Goblet Squat (Explosive)": {
    setup: ["Same as regular goblet squat", "Slightly heavier weight than Phase 1", "Mental cue: FAST UP"],
    exec: ["Control down 2s", "EXPLODE up as fast as possible", "Land stable; reset"],
    focus: ["Speed of the concentric (up phase)", "Still maintain form", "Think 'jump' without leaving ground"],
    mistakes: ["Bouncing out of bottom", "Losing balance on explosion", "Forgetting to go FAST"],
    why: ["Trains muscles to fire quickly", "Converts strength into power", "Bridges strength and jumping"]
  },
  "Jump Lunges": {
    setup: ["Start in lunge position", "Front knee at 90Â°; back knee hovering"],
    exec: ["Explode up; switch legs in air", "Land softly in opposite lunge", "Quick ground contact"],
    focus: ["Soft landings", "Vertical jump; not forward", "Quick turnaround between reps"],
    mistakes: ["Landing hard/stomping", "Too much forward movement", "Pausing between reps"],
    why: ["Explosive single-leg power", "Reactive strength for approach jumps", "High-intensity plyometric"]
  },
  "Reactive Calf Hops": {
    setup: ["Stand tall; hands on hips or at sides", "Weight on balls of feet"],
    exec: ["Quick small hops; minimal ground contact", "Ankle-dominant; knees barely bend", "Continuous rhythm; no pauses"],
    focus: ["Stiff ankles", "Land and immediately rebound", "Quiet, fast contacts"],
    mistakes: ["Deep knee bend (it's ankle hops)", "Long ground contact times", "Losing rhythm"],
    why: ["Develops ankle stiffness for jumping", "Improves elastic recoil", "Essential for reactive strength"]
  },
  "Pogo Hops": {
    setup: ["Stand tall; slight forward lean", "Arms at sides or hands on hips"],
    exec: ["Hop continuously with stiff ankles", "Minimal knee bend; all ankle", "Fast rhythm like bouncing ball"],
    focus: ["Stiff legs; elastic ankles", "Minimize ground contact time", "Forward progression optional"],
    mistakes: ["Bending knees too much", "Slow lazy hops", "Pausing between contacts"],
    why: ["Develops ankle elasticity", "Teaches fast ground contacts", "Primes nervous system for jumping"]
  },
  "Jump Squats": {
    setup: ["Feet shoulder-width; bodyweight only", "Hands behind head or at chest"],
    exec: ["Quick dip to quarter squat", "Explode up; leave ground", "Land softly; repeat immediately"],
    focus: ["Maximum jump height each rep", "Soft landings; reset quickly", "Fast transition from landing to jump"],
    mistakes: ["Squatting too deep (wastes time)", "Hard landings", "Too slow between reps"],
    why: ["Explosive power development", "Ballistic jumping movement", "Bridges strength and plyometrics"]
  },
  "Anti-Rotation Press": {
    setup: ["Band or cable at chest height", "Stand perpendicular to anchor", "Feet shoulder-width; athletic stance"],
    exec: ["Press arms straight out", "Hold 2-3s; resist rotation", "Return to chest; repeat"],
    focus: ["Core stays SQUARE; don't rotate", "Strong brace throughout", "Smooth pressing motion"],
    mistakes: ["Allowing torso to rotate", "Weak core engagement", "Using arms instead of resisting with core"],
    why: ["Anti-rotation core strength", "Stabilizes torso during jumps", "Prevents energy leaks in takeoff"]
  },
  "Romanian Deadlift": {
    setup: ["Feet hip width; soft knees; lats tight"],
    exec: ["Hips back; bar close; stand by squeezing glutes"],
    focus: ["Neutral spine", "Bar close"],
    mistakes: ["Locked knees", "Bar drifts"],
    why: ["Glute/ham drive adds inches"]
  },
  "Bulgarian Split Squat": {
    setup: ["Rear foot on bench; front out"],
    exec: ["Lower straight; slight forward torso; drive heel"],
    focus: ["Front leg works", "Knee over toes"],
    mistakes: ["Pushing off back leg"],
    why: ["Unilateral force in jump positions"]
  },
  "Standing Calf Raise (Loaded)": {
    setup: ["Machine or DBs"],
    exec: ["Full rise 1s; slow lower"],
    focus: ["No bounce", "Stay tall"],
    mistakes: ["Half reps", "Leaning"],
    why: ["Stronger plantarflexors"]
  },
  "Hanging Leg Raise": {
    setup: ["Hang from bar; ribs down; posterior tilt"],
    exec: ["Lift legs (or knees) to ~hip height; no swing"],
    focus: ["Control the eccentric", "Exhale on lift"],
    mistakes: ["Kipping/swinging", "Lumbar arch"],
    why: ["Anterior core control for power transfer"]
  },
  "Plank": {
    setup: ["Elbows under shoulders; straight line"],
    exec: ["Brace glutes/abs; breathe behind brace"],
    focus: ["Neutral spine"],
    mistakes: ["Sagging hips"],
    why: ["Rigid torso transmits leg power"]
  },
  "Two-step approach jumps": {
    setup: ["Clear space for 2-step approach", "Start from standstill"],
    exec: ["Two quick steps", "Plant outside foot", "Explode up with arm swing", "Land controlled"],
    focus: ["Quick plant", "Explosive takeoff", "Consistent approach"],
    mistakes: ["Choppy steps", "Slow approach", "Pulling back"],
    why: ["Develops approach jumping skill", "Transfers to game situations"]
  },
  "Touch rim/backboard": {
    setup: ["Basketball hoop or high target", "Your normal approach"],
    exec: ["Full approach", "Maximum vertical effort", "Touch target at peak", "Land safely"],
    focus: ["Commitment", "Full extension", "Consistent approach"],
    mistakes: ["Hesitation", "Changing approach mid-attempt"],
    why: ["Tests maximum vertical", "Skill practice", "Confidence building"]
  },
  "Form jumps": {
    setup: ["Feet shoulder-width", "Athletic stance"],
    exec: ["Quick dip to quarter squat", "Jump straight up", "Land softly", "Reset fully between reps"],
    focus: ["Perfect form every rep", "Quiet landings", "Knee tracking"],
    mistakes: ["Stomping", "Deep squat", "Rushing reps"],
    why: ["Builds jumping pattern", "Strengthens landing mechanics"]
  },
  "Arm Circles": {
    setup: ["Stand tall; arms out at shoulder height"],
    exec: ["Small-to-large circles 15 forward, 15 backward"],
    focus: ["Keep shoulders down/back", "Smooth rhythm"],
    mistakes: ["Shrugging", "Fast, jerky motion"],
    why: ["Warms GH joint and scapular control for pressing and arm swing"]
  },
  "Band Pull-Apart": {
    setup: ["Light band at chest height; hands shoulder width or wider"],
    exec: ["Pull by squeezing shoulder blades; return controlled"],
    focus: ["Ribs down", "Elbows soft"],
    mistakes: ["Overarching back", "Shrugging"],
    why: ["Posterior shoulder + mid-back activation; posture for stronger overhead/pressing"]
  },
  "Push-up to Down Dog": {
    setup: ["High plank; hands under shoulders"],
    exec: ["One push-up, then drive hips up into Down Dog; repeat"],
    focus: ["Maintain hollow body", "Active shoulder flexion at top"],
    mistakes: ["Sagging hips", "Neck craning"],
    why: ["Thoracic/shoulder mobility with trunk stiffnessâ€”better transfer for upper-day power"]
  },
  "Shoulder Taps": {
    setup: ["High plank; feet hipâ€“shoulder width"],
    exec: ["Tap opposite shoulder alternating without swaying"],
    focus: ["Hips level", "Strong brace"],
    mistakes: ["Hips rocking", "Locked-out breath"],
    why: ["Anti-rotation core + shoulder stability for pressing and landings"]
  },
  "Jumping Jacks": {
    setup: ["Athletic stance"],
    exec: ["Arms and legs move together for 30â€“45s"],
    focus: ["Rhythm and soft contacts"],
    mistakes: ["Heel slapping", "Arms half range"],
    why: ["General warm-up; raises temperature and primes stretchâ€“shortening cycle"]
  },
  "Barbell or DB Bench Press": {
    setup: ["Feet planted; shoulders back"],
    exec: ["Lower to mid-chest; elbows ~45Â°; press over shoulders"],
    focus: ["Stable base", "Explosive press"],
    mistakes: ["Flaring elbows"],
    why: ["Faster arm swing/finish"]
  },
  "Pull-Ups / Assisted Pull-Ups": {
    setup: ["Full hang; core tight"],
    exec: ["Pull chest to bar; elbows down"],
    focus: ["Full range", "No swing"],
    mistakes: ["Half reps"],
    why: ["Lat strength stabilizes shoulder"]
  },
  "Standing Overhead Press": {
    setup: ["Feet hip width; bar at collarbone"],
    exec: ["Press overhead; head through window"],
    focus: ["Straight path", "Ribs down"],
    mistakes: ["Overarching back"],
    why: ["Links leg drive to reach"]
  },
  "1-Arm Dumbbell Row": {
    setup: ["Bench or hinge"],
    exec: ["Pull toward hip; pause top"],
    focus: ["Shoulder down/back"],
    mistakes: ["Yanking"],
    why: ["Anti-rotation for plants/landings"]
  },
  "Triceps Dips or Pushdowns": {
    setup: ["Bars or cable"],
    exec: ["Elbows close; lower controlled"],
    focus: ["Squeeze lockout"],
    mistakes: ["Flared elbows"],
    why: ["Stronger finish at rim"]
  },
  "Side Plank": {
    setup: ["Elbow under shoulder; legs stacked"],
    exec: ["Lift hips; hold straight line"],
    focus: ["Hips high"],
    mistakes: ["Hips dropping"],
    why: ["Resists side-bend on approach"]
  },
  "Stability Ball Roll-outs": {
    setup: ["Kneel; forearms on ball"],
    exec: ["Roll forward keeping ribs down"],
    focus: ["No low-back arch"],
    mistakes: ["Overreaching"],
    why: ["Anterior core strength for hip drive"]
  },
  "Bird Dog": {
    setup: ["Hands under shoulders; knees under hips"],
    exec: ["Reach opposite arm/leg; brief hold"],
    focus: ["Hips level"],
    mistakes: ["Twisting"],
    why: ["Cross-body stability used in approach steps"]
  },
  "MB Chest Pass": {
    setup: ["Ball at chest"],
    exec: ["Explode; straight release"],
    focus: ["Fast push; follow-through"],
    mistakes: ["Slow throw"],
    why: ["Upper power, arm swing speed"]
  },
  "Overhead MB Slam": {
    setup: ["Ball overhead; ribs down"],
    exec: ["Slam hard"],
    focus: ["Full reach then snap"],
    mistakes: ["Overarch"],
    why: ["Triple flexion & trunk snap"]
  },
  "Clap or Plyo Push-ups": {
    setup: ["Push-up position"],
    exec: ["Explosive push; hands leave floor"],
    focus: ["Speed & control"],
    mistakes: ["Sagging hips"],
    why: ["Upper-body RFD"]
  },
  "Clap Push-ups": {
    setup: ["Push-up position", "Hands shoulder-width"],
    exec: ["Explosive push; hands leave floor", "Clap hands in air", "Land softly with hands ready"],
    focus: ["Speed & control", "Quick clap", "Safe landing"],
    mistakes: ["Sagging hips", "Landing hard on hands", "Slow push"],
    why: ["Upper-body explosive power", "Fast-twitch muscle development", "Arm speed for jumping"]
  },
  "Sprint 20 yds": {
    setup: ["Clear straight line"],
    exec: ["Accelerate; quick turnover"],
    focus: ["Powerful first steps"],
    mistakes: ["Overstride"],
    why: ["Raises neural drive for approaches"]
  },
  "Sprint 20 yds Ã— 6": {
    setup: ["Clear 20-yard straight line", "Full recovery between sprints"],
    exec: ["Explosive start from athletic stance", "Accelerate with quick turnover", "Maintain form through finish", "Walk back for recovery"],
    focus: ["Powerful first 3 steps", "High knee drive", "Relaxed shoulders", "Sprint through the line"],
    mistakes: ["Overstriding", "Tense upper body", "Slowing down at finish", "Not enough recovery between reps"],
    why: ["Develops acceleration mechanics", "Raises neural drive for approach jumps", "Builds explosive speed", "Primes fast-twitch fibers"]
  },
  "Dynamic Skips": {
    setup: ["Clear 20 yd lane"],
    exec: ["Tall posture; drive knee; opposite arm; skip rhythmically"],
    focus: ["Foot under hips", "Crisp arm drive"],
    mistakes: ["Overstriding", "Collapsed torso"],
    why: ["Elastic rhythm and coordination before plyometrics"]
  },
  "A-Skips & High Knees": {
    setup: ["20 yd lane"],
    exec: ["A-Skips 20 yds then High Knees 20 yds"],
    focus: ["Dorsiflexed foot", "Knee up, toe up, heel under"],
    mistakes: ["Toe-pointed contacts", "Backward lean"],
    why: ["Grooves sprint mechanics and fast contacts for approach jumps"]
  },
  "Light Bounding": {
    setup: ["Flat space"],
    exec: ["Short forward bounds with soft landings"],
    focus: ["Quick ground contact", "Knee over toes alignment"],
    mistakes: ["Heavy stomps", "Wobbly knees"],
    why: ["Teaches stiffness and horizontal propulsion safely"]
  },
  "Submax Jumps": {
    setup: ["Athletic stance"],
    exec: ["3 jumps at 50â€“70% height; land soft; reset each"],
    focus: ["Quiet feet", "Upright torso"],
    mistakes: ["Maxing effort", "Heels slamming"],
    why: ["Neural primer for later higher outputs"]
  },
  "Box Jumps": {
    setup: ["Face box 12-30 inches", "Feet hip-width", "Arms ready to swing", "Clear landing space on box"],
    exec: ["Quick dip to quarter squat", "Explosive jump onto box", "Land softly with knees tracking over toes", "Stand fully at top (full hip extension)", "Step down (don't jump down)"],
    focus: ["Soft landings every rep", "Full hip extension on box", "Quick ground contact", "Consistent approach"],
    mistakes: ["Box too high (can't land safely)", "Landing in deep squat", "Stomping on box", "Jumping down instead of stepping"],
    why: ["Develops rapid force production", "Teaches explosive leg power", "Improves vertical jump through plyometric training", "Safe way to train maximum effort jumps"]
  },
  "Box Jump": {
    setup: ["Face box 12-30 inches", "Feet hip-width", "Arms ready to swing", "Clear landing space on box"],
    exec: ["Quick dip to quarter squat", "Explosive jump onto box", "Land softly with knees tracking over toes", "Stand fully at top (full hip extension)", "Step down (don't jump down)"],
    focus: ["Soft landings every rep", "Full hip extension on box", "Quick ground contact", "Consistent approach"],
    mistakes: ["Box too high (can't land safely)", "Landing in deep squat", "Stomping on box", "Jumping down instead of stepping"],
    why: ["Develops rapid force production", "Teaches explosive leg power", "Improves vertical jump through plyometric training", "Safe way to train maximum effort jumps"]
  },
  "Broad Jump": {
    setup: ["Clear space ahead", "Feet hip-width", "Arms ready"],
    exec: ["Quick dip", "Swing arms forward", "Jump forward explosively", "Land with control", "Stick landing"],
    focus: ["Horizontal power", "Soft landing", "Hip drive"],
    mistakes: ["Falling forward", "Weak arm swing"],
    why: ["Horizontal force production", "Hip extension power"]
  },
  "Lateral Bounds": {
    setup: ["Stand on one leg", "Clear lateral space"],
    exec: ["Push off laterally", "Land on opposite leg", "Stick landing", "Alternate sides"],
    focus: ["Single-leg power", "Knee tracking", "Balance"],
    mistakes: ["Wobbly knee", "Short distance"],
    why: ["Lateral force", "Ankle/knee stability"]
  },
  "Depth Drops": {
    setup: ["Box 12-18 inches high", "Clear landing area", "Athletic stance on box"],
    exec: ["Step off box (don't jump off)", "Land on forefoot with knees tracking over toes", "Absorb force through hips, knees, ankles", "Either stick the landing or immediately rebound into vertical jump", "Reset and repeat"],
    focus: ["Soft landings", "Quick ground contact for rebounds", "Knee alignment", "Hip hinge to absorb force"],
    mistakes: ["Jumping off instead of stepping", "Box too high", "Knees caving inward", "Landing on heels", "Stiff legs"],
    why: ["Develops eccentric strength for landing control", "Teaches rapid force absorption and production", "Strengthens stretch-shortening cycle", "Reduces injury risk by improving landing mechanics"]
  },
  "Jump Squat (Bodyweight)": {
    setup: ["Athletic stance", "Hands ready"],
    exec: ["Quick dip", "Explode up", "Full extension", "Land soft", "Reset"],
    focus: ["Speed of movement", "Quiet landing", "Full effort"],
    mistakes: ["Too deep", "Slow movement"],
    why: ["Speed-strength", "Explosive power"]
  },
  "Trap/Barbell Deadlift": {
    setup: ["Feet hip-width", "Bar mid-foot", "Neutral spine"],
    exec: ["Brace core", "Push floor away", "Stand tall", "Controlled descent"],
    focus: ["Neutral spine", "Bar close", "Full hip extension"],
    mistakes: ["Rounding back", "Bar drifting"],
    why: ["Total-body force production", "Hip power"]
  },
  "Hip Thrust or Glute Bridge": {
    setup: ["Shoulders on bench or floor", "Feet flat"],
    exec: ["Drive through heels", "Squeeze glutes at top", "Lower controlled"],
    focus: ["Posterior pelvic tilt", "Full hip extension"],
    mistakes: ["Overarching", "Short range"],
    why: ["Direct glute activation", "Hip extension power"]
  },
  "Dunk Attempts": {
    setup: ["Basketball in hand", "Your preferred approach (1-step, 2-step, or full run)", "Rim or adjustable goal"],
    exec: ["Full speed approach with consistent footwork", "Explosive plant and takeoff", "Drive ball up with arm extension", "Attempt to dunk or touch rim with ball", "Land safely and controlled"],
    focus: ["Commitment to the attempt", "Consistent approach every rep", "Maximum effort", "Confidence at takeoff"],
    mistakes: ["Hesitation or slowing down", "Changing approach mid-attempt", "Pulling back at last second", "Unsafe landing"],
    why: ["Skill practice with maximum intent", "Neurological adaptation to game-speed jumping", "Builds confidence and timing", "Translates training to actual dunking ability"]
  },
  "Dunk attempts": {
    setup: ["Basketball in hand", "Your preferred approach (1-step, 2-step, or full run)", "Rim or adjustable goal"],
    exec: ["Full speed approach with consistent footwork", "Explosive plant and takeoff", "Drive ball up with arm extension", "Attempt to dunk or touch rim with ball", "Land safely and controlled"],
    focus: ["Commitment to the attempt", "Consistent approach every rep", "Maximum effort", "Confidence at takeoff"],
    mistakes: ["Hesitation or slowing down", "Changing approach mid-attempt", "Pulling back at last second", "Unsafe landing"],
    why: ["Skill practice with maximum intent", "Neurological adaptation to game-speed jumping", "Builds confidence and timing", "Translates training to actual dunking ability"]
  },
  "Back Squat (Explosive)": {
    setup: ["Bar on upper back", "Feet shoulder width", "Brace core hard"],
    exec: ["Lower controlled for 2s", "Explode up as fast as possible", "Full hip extension", "Reset between reps"],
    focus: ["Speed on the way up", "Stay tight at bottom", "Drive through heels"],
    mistakes: ["Bouncing out of hole", "Slow ascent", "Loose core"],
    why: ["Converts base strength into explosive power", "Trains rate of force development", "Neurological adaptation for quick force production"]
  },
  "Power Clean or KB Swing": {
    setup: ["Bar at mid-shin or KB on floor", "Feet hip width", "Tight lats and core"],
    exec: ["Explosive hip extension", "Shrug and pull", "Catch at shoulders (clean) or swing to eye level (KB)", "Control the descent"],
    focus: ["Violent hip snap", "Keep bar/KB close", "Fast elbows (clean)"],
    mistakes: ["Arm pull instead of hip drive", "Bar drifts away", "Slow tempo"],
    why: ["Develops explosive hip power", "Trains triple extension", "Translates directly to jumping force"]
  },
  "Depth Drop â†’ Vertical Jump": {
    setup: ["Box 12-18 inches", "Flat landing area", "Athletic stance"],
    exec: ["Step off box", "Land on both feet", "Immediately jump max vertical", "Minimal ground contact time"],
    focus: ["Quick transition", "Explosive jump", "Soft initial landing"],
    mistakes: ["Too high box", "Long ground contact", "Collapsing on landing"],
    why: ["Develops reactive strength", "Trains stretch-shortening cycle", "Explosive power from pre-stretch"]
  },
  "Depth Drop â†’ Vertical": {
    setup: ["Box 12-18 inches", "Flat landing area", "Athletic stance"],
    exec: ["Step off box (don't jump)", "Land on both feet softly", "Immediately explode into max vertical jump", "Minimal ground contact time"],
    focus: ["Quick transition landing-to-jump", "Explosive vertical jump", "Soft initial landing"],
    mistakes: ["Box too high for ability", "Long ground contact time", "Collapsing on landing", "Not jumping vertically"],
    why: ["Develops reactive strength", "Trains stretch-shortening cycle", "Explosive power from pre-stretch", "Game-specific plyometric"]
  },
  "Explosive Bench or Plyo Push-ups": {
    setup: ["Bench or floor", "Hands shoulder width", "Tight core and glutes"],
    exec: ["Lower controlled", "Explode up (hands leave surface for plyo)", "Land with control"],
    focus: ["Maximum speed up", "Control the landing", "Tight body position"],
    mistakes: ["Sagging hips", "Slow press", "Elbows flaring"],
    why: ["Explosive upper body power", "Fast arm drive for jumping", "Rate of force development"]
  },
  "Medicine Ball Chest Throw": {
    setup: ["Med ball at chest", "Athletic stance", "Partner or wall"],
    exec: ["Explosive push from chest", "Full arm extension", "Follow through", "Catch and reset"],
    focus: ["Maximum speed", "Full extension", "Power from chest"],
    mistakes: ["Slow throw", "Arms only", "No follow through"],
    why: ["Ballistic pressing power", "Uses bench strength explosively", "Translates to arm swing speed"]
  },
  "Pull-Ups (Explosive)": {
    setup: ["Full hang", "Hands shoulder width", "Core tight"],
    exec: ["Explode up as fast as possible", "Chest to bar", "Control down", "Reset at bottom"],
    focus: ["Speed up", "Full range", "No swing"],
    mistakes: ["Kipping unnecessarily", "Partial reps", "Slow pull"],
    why: ["Explosive pulling power", "Lat speed and strength", "Arm drive for jumping"]
  },
  "Overhead Medicine Ball Slam": {
    setup: ["Med ball overhead", "Feet shoulder width", "Core braced"],
    exec: ["Reach tall", "Violently slam ball down", "Use whole body", "Pick up and reset"],
    focus: ["Maximum force", "Full body snap", "Explosive"],
    mistakes: ["Arms only", "No hip involvement", "Slow tempo"],
    why: ["Total body explosive power", "Core to extremity power transfer", "Aggressive force production"]
  },
  "Battle Ropes or Speed Rope": {
    setup: ["Ropes or jump rope", "Athletic stance", "Core engaged"],
    exec: ["Rapid alternating waves (battle ropes) or fast skips (speed rope)", "Maintain intensity", "Quick arm action"],
    focus: ["Arm speed", "Rhythm", "Sustained intensity"],
    mistakes: ["Slow tempo", "Arms only", "Poor posture"],
    why: ["Arm speed endurance", "Fast-twitch activation", "Conditioning for explosive movements"]
  },
  "Box Jump (Higher Box)": {
    setup: ["Box 24-36 inches (higher than Phase 1)", "Safe landing area", "Athletic stance"],
    exec: ["Powerful arm swing", "Explosive jump", "Land softly on box", "Stand fully", "Step down"],
    focus: ["Maximum height", "Soft landing", "Full hip extension"],
    mistakes: ["Too high too soon", "Pulling knees up instead of jumping high", "Heavy landing"],
    why: ["Peak power output", "Maximum vertical training", "Confidence at higher heights"]
  },
  "Single-Leg Bounds": {
    setup: ["One leg", "Open space", "Athletic posture"],
    exec: ["Powerful bound forward on one leg", "Maximum distance and height", "Land same leg", "Repeat for reps"],
    focus: ["Maximum effort each rep", "Control landing", "Drive knee and arms"],
    mistakes: ["Tentative effort", "Poor landing control", "Not using arms"],
    why: ["Unilateral explosive power", "Single-leg force production", "Game-specific movement pattern"]
  },
  "Depth Drop â†’ Max Vertical": {
    setup: ["Box 12-24 inches", "Flat area", "Max effort mindset"],
    exec: ["Step off", "Absorb landing", "Immediately explode into max vertical jump", "Touch highest point possible"],
    focus: ["Minimal ground contact", "Maximum jump height", "Quick transition"],
    mistakes: ["Too long on ground", "Timid jump", "Collapsing on landing"],
    why: ["Peak reactive power", "Trains maximum SSC utilization", "Competition-level intensity"]
  },
  "Contrast Jump Squats": {
    setup: ["Light barbell or dumbbells (20-30% of max squat)", "Feet shoulder width"],
    exec: ["Quick descent to quarter squat", "Explode up", "Jump if possible", "Land controlled"],
    focus: ["Maximum speed with load", "Explosive intent", "Quick ground contact"],
    mistakes: ["Too heavy", "Slow tempo", "Deep squat"],
    why: ["Speed-strength development", "Bridges heavy strength to explosive jumping", "Post-activation potentiation"]
  },
  // ===== MISSING PHASE 2 COACH CARDS ADDED =====
  "Hanging Leg Raise (Explosive)": {
    setup: ["Hang from bar with overhand grip", "Shoulders engaged; ribs down", "Posterior pelvic tilt"],
    exec: ["EXPLOSIVE lift of legs to hip height or higher", "Quick, powerful movement", "Control descent over 2s", "No swinging or kipping"],
    focus: ["Maximum speed on the way up", "Control on the way down", "Exhale forcefully on lift", "Strong core brace throughout"],
    mistakes: ["Using momentum/swinging", "Letting legs drop uncontrolled", "Lumbar arch/rib flare", "Not going explosive enough"],
    why: ["Develops explosive core power for jumping", "Trains rate of force development in anterior chain", "Faster core engagement = more power transfer to legs", "Bridges core strength to explosive movements"]
  },
  "Max Vertical Jump Test": {
    setup: ["Clear vertical space", "Use your preferred approach (1-step, 2-step, or run-up)", "Mark or measure system ready", "Warm and ready for maximum effort"],
    exec: ["Approach at full speed", "Plant and explode with maximum intent", "Reach as high as possible at peak", "Measure and record height", "Full recovery between attempts"],
    focus: ["100% effort every rep", "Consistent approach", "Maximum arm swing", "Full extension at peak"],
    mistakes: ["Holding back effort", "Changing approach between reps", "Not enough rest between attempts", "Poor measurement technique"],
    why: ["Tests your maximum vertical jump ability", "Tracks progress objectively", "Identifies areas for improvement", "Builds confidence and competitive mindset"]
  },
  "Bounding": {
    setup: ["Clear open space for 15+ bounds", "Athletic posture", "Forward lean ready"],
    exec: ["Powerful forward bounds", "Maximum distance each bound", "Quick powerful ground contacts", "Aggressive arm drive", "Continuous forward momentum"],
    focus: ["Distance over height", "Powerful push-off", "Quick transitions", "Strong arm action"],
    mistakes: ["Too vertical (up instead of out)", "Long ground contact times", "Weak arm drive", "Breaking momentum between bounds"],
    why: ["Develops horizontal power for approach jumps", "Builds explosive single-leg strength", "Trains powerful ground contacts", "Game-specific movement pattern"]
  },
  "Max Jumps": {
    setup: ["Athletic stance", "Feet shoulder-width", "Full warm-up completed"],
    exec: ["Jump at 80-90% of maximum effort", "Full approach if desired", "Focus on perfect form", "Soft controlled landing each rep", "Reset between jumps"],
    focus: ["Near-max intensity without full exhaustion", "Maintain perfect technique", "Powerful but controlled", "Quality over absolute max"],
    mistakes: ["Going to true 100% max (save for testing)", "Sacrificing form for height", "Not enough recovery", "Sloppy landings"],
    why: ["Primes nervous system for maximum output", "Builds confidence near peak intensity", "Reinforces perfect jumping mechanics", "Neural activation without excessive fatigue"]
  },
  "Explosive Deadlift": {
    setup: ["Barbell loaded to 60-75% of max", "Feet hip-width under bar", "Neutral spine; tight lats", "Explosive mindset"],
    exec: ["Set up perfectly", "Initiate with controlled pull", "EXPLOSIVE acceleration through mid-range", "Violent hip extension", "Control the descent"],
    focus: ["Speed through the middle", "Aggressive hip snap", "Keep bar close", "Maximum velocity intent"],
    mistakes: ["Going too heavy (can't move fast)", "Slow off the floor", "Bar drifts away", "Rounding back for speed"],
    why: ["Converts deadlift strength into explosive power", "Develops rapid force production", "Trains triple extension at speed", "Directly mimics jumping mechanics"]
  },
  "Hip Thrust (Explosive)": {
    setup: ["Shoulders on bench", "Feet flat hip-width apart", "Bar or weight across hips", "60-75% of regular hip thrust weight"],
    exec: ["Lower controlled", "EXPLOSIVE drive through heels", "Violent hip extension", "Squeeze glutes hard at top", "Quick tempo"],
    focus: ["Maximum speed up", "Full hip extension", "Posterior tilt at top", "Maintain speed across all reps"],
    mistakes: ["Too heavy (can't move fast)", "Overarching back", "Slow grinding reps", "Partial range of motion"],
    why: ["Explosive glute power for takeoff", "Trains hip extension speed", "Converts hip thrust strength to jumping power", "Peak power development for vertical jump"]
  },
  "Max approach jumps": {
    setup: ["Your normal full approach", "Clear runway and landing area", "Maximum effort mindset"],
    exec: ["Full-speed approach", "Explosive plant and takeoff", "Maximum vertical effort", "Full extension at peak", "Controlled landing"],
    focus: ["Commitment to full speed", "Perfect timing", "Maximum effort", "Consistency in approach"],
    mistakes: ["Slowing down before plant", "Hesitation", "Inconsistent approach", "Not giving 100%"],
    why: ["Simulates game situations at max intensity", "Tests approach jumping skill", "Builds confidence at full speed", "Neural adaptation to maximum output"]
  },
  "Touch highest point": {
    setup: ["Highest target you can reach", "Your preferred approach", "Basketball or marker ready"],
    exec: ["Full approach at game speed", "Maximum vertical jump", "Touch/reach highest possible point", "Record height if possible", "Full recovery between attempts"],
    focus: ["Reach as high as humanly possible", "Full extension", "Commitment", "Consistent approach"],
    mistakes: ["Holding back", "Changing approach", "Not fully extending", "Inadequate rest"],
    why: ["Tests absolute maximum reach", "Objective measurement of progress", "Confidence builder", "Competition simulation"]
  },
  "Dunk Attempts (Max Effort)": {
    setup: ["Basketball in hand", "Your preferred approach (1-step, 2-step, or full run)", "Rim at standard or adjustable height", "Maximum intensity mindset"],
    exec: ["Full speed approach with perfect footwork", "100% explosive plant and takeoff", "MAXIMUM EFFORT - everything you have", "Drive ball up with full arm extension", "Attempt to dunk with complete commitment", "Land safely"],
    focus: ["Absolute maximum effort every rep", "No holding back - give it everything", "Consistent approach mechanics", "Full confidence and aggression", "This is where all training pays off"],
    mistakes: ["Any hesitation whatsoever", "Pulling back at takeoff", "Not committing fully", "Changing approach pattern", "Mental doubt"],
    why: ["Peak performance under maximum intent", "Complete transfer of training to skill", "Neurological adaptation at highest level", "This is game time - everything counts", "Builds unshakeable confidence"]
  }
};

const WEEKS=12;
const listKey="osc_players";
const key=(p,d,w)=>`osc_p${p}_d${d}_w${w}`;
const settingsKey=(p)=>`osc_settings_${p}`;
const xpKey=(p)=>`osc_xp_${p}`;
const earnedKey=(p)=>`osc_earned_${p}`;
const boundPlayerKey='osc_bound_player';

/* UI elements */
const daySel=document.getElementById('daySel');
const weekSel=document.getElementById('week');
const whyDiv=document.getElementById('why');
const content=document.getElementById('content');
const notes=document.getElementById('notes');
const exportBtn=document.getElementById('exportCsv');
const xpbar=document.getElementById('xpbar');
const playerName=document.getElementById('playerName');
const playerStats=document.getElementById('playerStats');

/* Storage functions */
function loadSettings(p){ return JSON.parse(localStorage.getItem(settingsKey(p))||'{"school":"CORE Butte High","mascot":"Lynx","colors":"Blue & White","coachUrl":""}'); }
function saveSettings(p,s){ localStorage.setItem(settingsKey(p), JSON.stringify(s)); }
function loadEntry(p,d,w){ const raw=localStorage.getItem(key(p,d,w)); return raw?JSON.parse(raw):null; }
function saveEntry(p,d,w,val){ 
  localStorage.setItem(key(p,d,w), JSON.stringify(val));
  sendCoachSnapshotDebounced();
}
function getXP(p){ return +(localStorage.getItem(xpKey(p))||0); }
function setXP(p,v){ localStorage.setItem(xpKey(p), v); }
function loadEarned(p){ return JSON.parse(localStorage.getItem(earnedKey(p))||'{}'); }
function saveEarned(p,m){ localStorage.setItem(earnedKey(p), JSON.stringify(m)); }

function currentPlayer(){ return localStorage.getItem(boundPlayerKey) || null; }
function promptForNameOnce(){
  let nm = localStorage.getItem(boundPlayerKey);
  if(nm) return nm;
  while(!nm){
    nm = (prompt("Enter your name to set up your app")||"").trim();
    if(!nm) alert("Name is required.");
  }
  localStorage.setItem(boundPlayerKey,nm);
  return nm;
}

/* XP functions (streak removed - now coach-only metric) */

function getTotalWorkouts(p) {
  const WEEKS = 12;
  const DAYS = 3;
  let total = 0;
  
  for (let w = 1; w <= WEEKS; w++) {
    for (let d = 1; d <= DAYS; d++) {
      const entry = loadEntry(p, d, w);
      if (entry) {
        // Count if at least one exercise was completed
        const hasProgress = 
          (entry.warmup && entry.warmup.some(x => x)) ||
          (entry.core && entry.core.some(x => x)) ||
          (entry.jump && entry.jump.some(x => x)) ||
          (entry.strength && entry.strength.some(blk => blk.sets.some(s => s.done)));
        
        if (hasProgress) total++;
      }
    }
  }
  return total;
}

function updateXPView(p){ 
  const x = getXP(p);
  const workouts = getTotalWorkouts(p);
  const w = +weekSel.value || 1;
  const d = +daySel.value || 1;
  
  // Update player name
  playerName.textContent = p || "Player";
  
  // Update stats line (no streak - coach-only metric)
  playerStats.textContent = `Week ${w}, Day ${d} â€¢ ${x} XP â€¢ ${workouts} Workouts`;
  
  // Update progress bar (0-100 XP cycle)
  const pct = Math.min(100, (x % 100)); 
  xpbar.style.width = pct + "%";
}

function awardXPOnce(p,id,amt){ 
  const m=loadEarned(p); 
  if(m[id]) return; 
  m[id]=amt; 
  saveEarned(p,m); 
  setXP(p,getXP(p)+amt); 
  updateXPView(p); 
}

function updatePhaseLabel(){ 
  // Phase label removed from UI - function kept for compatibility
}

/* Initialize workout data structure */
function init(week, day){ 
  const prog = getProgram(week, day);
  return {
    warmup: prog.warmup.map(()=>false),
    strength: prog.strength.map(b=>({
      weight:"",
      notes:"",
      sets:Array.from({length:b.sets},()=>({done:false}))
    })),
    core: prog.core.map(()=>false),
    jump: prog.jump.map(()=>false),
    notes:""
  }; 
}

/* Exercise modal */
function openTrainer(name) {
  const base = name.split(' â€” ')[0];
  const d = EX[base];
  if (!d) return;
  
  const modal = document.getElementById('trainerModal');
  const title = document.getElementById('mTitle');
  const modalContent = document.getElementById('modalContent');
  
  title.textContent = base;
  
  let html = '';
  
  // LEFT COLUMN
  let leftCol = '';
  
  if (d.setup && d.setup.length > 0) {
    leftCol += `
      <div>
        <div class="section-header">
          <span class="icon">ðŸŽ¯</span>
          <span class="title">Setup</span>
        </div>
        <ul class="setup-list">
          ${d.setup.map((item, i) => `<li data-step="${i+1}">${item}</li>`).join('')}
        </ul>
      </div>
    `;
  }
  
  if (d.exec && d.exec.length > 0) {
    leftCol += `
      <div>
        <div class="section-header">
          <span class="icon">âš¡</span>
          <span class="title">Execution</span>
        </div>
        <ul class="exec-list">
          ${d.exec.map((item, i) => `<li data-step="${i+1}">${item}</li>`).join('')}
        </ul>
      </div>
    `;
  }
  
  // RIGHT COLUMN
  let rightCol = '';
  
  if (d.focus && d.focus.length > 0) {
    rightCol += `
      <div>
        <div class="section-header">
          <span class="icon">âœ“</span>
          <span class="title">Focus Cues</span>
        </div>
        <ul class="focus-list">
          ${d.focus.map((item) => `<li>${item}</li>`).join('')}
        </ul>
      </div>
    `;
  }
  
  if (d.mistakes && d.mistakes.length > 0) {
    rightCol += `
      <div>
        <div class="section-header">
          <span class="icon">âš ï¸</span>
          <span class="title">Avoid</span>
        </div>
        <ul class="mistakes-list">
          ${d.mistakes.map((item) => `<li>${item}</li>`).join('')}
        </ul>
      </div>
    `;
  }
  
  if (d.why && d.why.length > 0) {
    rightCol += `
      <div>
        <div class="section-header">
          <span class="icon">ðŸ’ª</span>
          <span class="title">Why This Works</span>
        </div>
        <ul class="why-list">
          ${d.why.map((item) => `<li>${item}</li>`).join('')}
        </ul>
      </div>
    `;
  }
  
  html = `
    <div>${leftCol}</div>
    <div>${rightCol}</div>
  `;
  
  modalContent.innerHTML = html;
  modal.style.display = 'flex';
}

document.getElementById('mClose').onclick = () => {
  document.getElementById('trainerModal').style.display = 'none';
};

document.getElementById('trainerModal').onclick = (e) => {
  if (e.target.id === 'trainerModal') {
    document.getElementById('trainerModal').style.display = 'none';
  }
};

/* Export to CSV (streak removed - now coach-only metric) */
exportBtn.onclick = () => { 
  const p = currentPlayer();
  const d = +daySel.value;
  const w = +weekSel.value; 
  const prog = getProgram(w, d);
  const e = loadEntry(p, d, w) || init(w, d); 
  
  // CSV headers: 10 columns (removed Streak)
  const rows = [["Player", "Week", "Day", "Section", "Item", "Set", "Done", "Weight", "Notes", "XP"]];
  
  // Warmup rows (no streak)
  e.warmup.forEach((ck, i) => rows.push([p, w, d, "Warmup", prog.warmup[i], "", ck ? "yes" : "", "", "", getXP(p)]));
  
  // Strength rows (no streak)
  e.strength.forEach((blk, i) => { 
    const ex = prog.strength[i].ex; 
    blk.sets.forEach((st, si) => rows.push([p, w, d, "Strength", ex, si + 1, st.done ? "yes" : "", blk.weight || "", blk.notes || "", getXP(p)])); 
  });
  
  // Core rows (no streak)
  e.core.forEach((ck, i) => rows.push([p, w, d, "Core", prog.core[i], "", ck ? "yes" : "", "", "", getXP(p)]));
  
  // Jump rows (no streak)
  e.jump.forEach((ck, i) => rows.push([p, w, d, "Jump", prog.jump[i], "", ck ? "yes" : "", "", "", getXP(p)]));
  
  const csv = rows.map(r => r.map(x => `"${(x ?? "").toString().replace(/"/g, '""')}"`).join(",")).join("\n"); 
  const a = document.createElement('a'); 
  a.href = URL.createObjectURL(new Blob([csv], {type: "text/csv"})); 
  a.download = `OSC_${p}_w${w}_d${d}.csv`; 
  a.click(); 
};

/* Calculate totals */
function totalBoxes(week, day) {
  const prog = getProgram(week, day);
  let t = 0;
  t += prog.warmup.length + prog.core.length + prog.jump.length;
  prog.strength.forEach(blk => t += blk.sets);
  return t;
}

function currentDone(data, week, day) {
  let c = 0;
  data.warmup.forEach(x => {if(x)c++;});
  data.core.forEach(x => {if(x)c++;});
  data.jump.forEach(x => {if(x)c++;});
  const prog = getProgram(week, day);
  prog.strength.forEach((blk, i) => data.strength[i].sets.forEach(s => {if(s.done)c++;}));
  return c;
}

/* ===== UPDATED RENDER FUNCTION WITH POLISHED STYLING ===== */
function render() {
  updatePhaseLabel();
  const p = currentPlayer();
  const d = +daySel.value;
  const w = +weekSel.value || 1;
  const prog = getProgram(w, d);
  
  const data = loadEntry(p, d, w) || init(w, d);
  
  updateXPView(p);
  
  // ===== PROGRAM ARCHITECTURE - SHOWS HOW IT ALL CONNECTS =====
  
  const phase = (w <= 6) ? 'foundation' : 'power';
  const weekProgress = Math.round((w / WEEKS) * 100);
  
  // Architecture data: what each phase builds
  const architectureData = {
    foundation: {
      icon: "ðŸ‹ï¸",
      title: "Foundation Layer",
      weeks: "Weeks 1-6",
      focus: "Building the base for explosive power",
      connections: {
        1: [ // Day 1 connections
          { from: "Leg Strength", to: "Launch Power" },
          { from: "Joint Stability", to: "Safe Landings" },
          { from: "Movement Patterns", to: "Efficiency" }
        ],
        2: [ // Day 2 connections
          { from: "Core Stability", to: "Power Transfer" },
          { from: "Arm Swing Strength", to: "Takeoff Speed" },
          { from: "Upper Body Control", to: "Rim Finishes" }
        ],
        3: [ // Day 3 connections
          { from: "Nervous System Training", to: "Quick Reflexes" },
          { from: "Reactive Strength", to: "Fast Ground Contacts" },
          { from: "Approach Coordination", to: "Explosive Timing" }
        ]
      }
    },
    power: {
      icon: "ðŸš€",
      title: "Power Layer",
      weeks: "Weeks 7-12",
      focus: "Converting strength into explosion",
      connections: {
        1: [ // Day 1 connections
          { from: "Base Strength", to: "Explosive Power" },
          { from: "Fast-Twitch Fibers", to: "Peak Output" },
          { from: "Leg Drive", to: "Max Vertical" }
        ],
        2: [ // Day 2 connections
          { from: "Core Stability", to: "Power Transfer" },
          { from: "Arm Swing Speed", to: "Takeoff Velocity" },
          { from: "Upper Body Control", to: "Rim Finishes" }
        ],
        3: [ // Day 3 connections
          { from: "Elastic Strength", to: "Quick Contacts" },
          { from: "Approach Mechanics", to: "Game Speed Power" },
          { from: "Body Control", to: "Championship Performance" }
        ]
      }
    }
  };
  
  const currentPhase = architectureData[phase];
  const otherPhase = (phase === 'foundation') ? architectureData.power : architectureData.foundation;
  const currentConnections = currentPhase.connections[d] || currentPhase.connections[1];
  
  // Badge text based on week
  let badgeText = "YOU ARE HERE";
  if (w === 6) badgeText = "PHASE 1 COMPLETE";
  if (w === 12) badgeText = "PEAK WEEK";
  
  // Build the architecture view
  let architectureHTML = `
    <div class="architecture-section day${d}">
      <div class="arch-header">Program Architecture</div>
      <div class="arch-layers">
  `;
  
  // If in power phase, show completed foundation first
  if (phase === 'power') {
    architectureHTML += `
      <div class="arch-layer completed">
        <div class="layer-header">
          <div class="layer-title">âœ… ${architectureData.foundation.title}</div>
          <div class="layer-weeks">${architectureData.foundation.weeks}</div>
        </div>
        <div class="layer-focus">Base strength established</div>
      </div>
    `;
  }
  
  // Current phase (highlighted)
  architectureHTML += `
    <div class="arch-layer current">
      <div class="current-badge">${badgeText}</div>
      <div class="layer-header">
        <div class="layer-title">${currentPhase.icon} ${currentPhase.title}</div>
        <div class="layer-weeks">${currentPhase.weeks}</div>
      </div>
      <div class="layer-focus">${currentPhase.focus}</div>
      <div class="layer-bullets">
        ${currentConnections.map(conn => `
          <div class="layer-bullet">
            <span class="bullet-arrow">â†’</span>
            <div><span class="bullet-from">${conn.from}</span> builds <span class="bullet-to">${conn.to}</span></div>
          </div>
        `).join('')}
      </div>
    </div>
  `;
  
  // If in foundation phase, show future power phase (dimmed)
  if (phase === 'foundation') {
    architectureHTML += `
      <div class="arch-layer future">
        <div class="layer-header">
          <div class="layer-title">${otherPhase.icon} ${otherPhase.title}</div>
          <div class="layer-weeks">${otherPhase.weeks}</div>
        </div>
        <div class="layer-focus">${otherPhase.focus}</div>
      </div>
    `;
  }
  
  // Progress bar
  let progressText = `Week ${w} of ${WEEKS}`;
  if (w === 12) progressText = `Week 12 of 12 â€” TIME TO FLY`;
  
  architectureHTML += `
      </div>
      <div class="arch-progress">
        <div class="progress-label">Program Progress</div>
        <div class="progress-bar">
          <div class="progress-fill" style="width: ${weekProgress}%"></div>
        </div>
        <div class="progress-text">${progressText}</div>
      </div>
    </div>
  `;
  
  whyDiv.innerHTML = architectureHTML;
  
  const total = totalBoxes(w, d);
  const done = currentDone(data, w, d);
  xpbar.style.width = (100 * done / total) + "%";
  
  content.innerHTML = "";
  
  // ===== WARMUP SECTION (POLISHED) =====
  const warm = document.createElement('div');
  warm.className = "card";
  
  const warmHeader = document.createElement('div');
  warmHeader.className = "section-header warmup";
  warmHeader.innerHTML = `
    <span class="icon">ðŸ”¥</span>
    <span class="title">Warm-Up</span>
  `;
  warm.appendChild(warmHeader);
  
  prog.warmup.forEach((it, idx) => {
    const item = document.createElement('div');
    item.className = "exercise-item warmup";
    
    const id = `wu_${d}_${idx}`;
    const cb = document.createElement('input');
    cb.type = "checkbox";
    cb.checked = data.warmup[idx];
    cb.onchange = () => {
      data.warmup[idx] = cb.checked;
      saveEntry(p, d, w, data);
      if (cb.checked) { awardXPOnce(p, id, 5); }
      xpbar.style.width = (100 * currentDone(data, w, d) / total) + "%";
    };
    
    const link = document.createElement('span');
    link.className = "exercise-link";
    link.textContent = it;
    link.onclick = () => openTrainer(it);
    
    item.appendChild(cb);
    item.appendChild(link);
    warm.appendChild(item);
  });
  content.appendChild(warm);
  
  // ===== CORE SECTION (OPTIMIZED: MOVED BEFORE JUMP/STRENGTH) =====
  // Core activation before plyometrics "wakes up" stabilizing muscles
  const core = document.createElement('div');
  core.className = "card";
  
  const coreHeader = document.createElement('div');
  coreHeader.className = "section-header core";
  coreHeader.innerHTML = `
    <span class="icon">âš¡</span>
    <span class="title">Core Activation</span>
  `;
  core.appendChild(coreHeader);
  
  prog.core.forEach((it, idx) => {
    const item = document.createElement('div');
    item.className = "exercise-item core";
    
    const id = `co_${d}_${idx}`;
    const cb = document.createElement('input');
    cb.type = "checkbox";
    cb.checked = data.core[idx];
    cb.onchange = () => {
      data.core[idx] = cb.checked;
      saveEntry(p, d, w, data);
      if (cb.checked) awardXPOnce(p, id, 5);
      xpbar.style.width = (100 * currentDone(data, w, d) / total) + "%";
    };
    
    const link = document.createElement('span');
    link.className = "exercise-link";
    link.textContent = it;
    link.onclick = () => openTrainer(it);
    
    item.appendChild(cb);
    item.appendChild(link);
    core.appendChild(item);
  });
  content.appendChild(core);
  
  // ===== JUMP SECTION (OPTIMIZED: MOVED BEFORE STRENGTH) =====
  // Plyometrics performed when FRESH for maximum quality and safety
  const jump = document.createElement('div');
  jump.className = "card";
  
  const jumpHeader = document.createElement('div');
  jumpHeader.className = "section-header jump";
  jumpHeader.innerHTML = `
    <span class="icon">ðŸš€</span>
    <span class="title">Jump Mechanics</span>
  `;
  jump.appendChild(jumpHeader);
  
  prog.jump.forEach((it, idx) => {
    const item = document.createElement('div');
    item.className = "exercise-item jump";
    
    const id = `jm_${d}_${idx}`;
    const cb = document.createElement('input');
    cb.type = "checkbox";
    cb.checked = data.jump[idx];
    cb.onchange = () => {
      data.jump[idx] = cb.checked;
      saveEntry(p, d, w, data);
      if (cb.checked) awardXPOnce(p, id, 8);
      xpbar.style.width = (100 * currentDone(data, w, d) / total) + "%";
    };
    
    const link = document.createElement('span');
    link.className = "exercise-link";
    link.textContent = it;
    link.onclick = () => openTrainer(it);
    
    item.appendChild(cb);
    item.appendChild(link);
    jump.appendChild(item);
  });
  content.appendChild(jump);
  
  // ===== STRENGTH SECTION (OPTIMIZED: MOVED AFTER JUMP) =====
  // Heavy strength work performed last to preserve explosive performance
  const str = document.createElement('div');
  str.className = "card";
  
  const strHeader = document.createElement('div');
  strHeader.className = "section-header strength";
  strHeader.innerHTML = `
    <span class="icon">ðŸ’ª</span>
    <span class="title">Strength Training</span>
  `;
  str.appendChild(strHeader);
  
  const gridHeader = document.createElement('div');
  gridHeader.className = "grid gridHeader";
  gridHeader.innerHTML = "<div>Exercise</div><div>Sets</div><div>Reps</div><div>Weight / Notes</div>";
  str.appendChild(gridHeader);
  
  prog.strength.forEach((blk, bi) => {
    const g = document.createElement('div');
    g.className = "grid";
    
    const link = document.createElement('span');
    link.className = "exercise-link";
    link.textContent = blk.ex;
    link.onclick = () => openTrainer(blk.ex);
    
    const c1 = document.createElement('div');
    c1.appendChild(link);
    g.appendChild(c1);
    
    const c2 = document.createElement('div');
    c2.textContent = blk.sets;
    g.appendChild(c2);
    
    const c3 = document.createElement('div');
    c3.textContent = blk.reps;
    g.appendChild(c3);
    
    const c4 = document.createElement('div');
    if (blk.weighted) {
      const winput = document.createElement('input');
      winput.placeholder = "lb";
      winput.style.width = "100%";
      winput.value = (data.strength[bi].weight || "");
      winput.oninput = () => {
        data.strength[bi].weight = winput.value;
        saveEntry(p, d, w, data);
      };
      c4.appendChild(winput);
    }
    const tarea = document.createElement('textarea');
    tarea.className = "note";
    tarea.placeholder = "Notes";
    tarea.value = (data.strength[bi].notes || "");
    tarea.oninput = () => {
      data.strength[bi].notes = tarea.value;
      saveEntry(p, d, w, data);
    };
    c4.appendChild(tarea);
    g.appendChild(c4);
    str.appendChild(g);
    
    // NUMBERED SET CIRCLES
    const setContainer = document.createElement('div');
    setContainer.className = "set-container";
    
    for (let s = 0; s < blk.sets; s++) {
      const setItem = document.createElement('div');
      setItem.className = "set-item";
      setItem.setAttribute('data-set', s + 1);
      
      const cb = document.createElement('input');
      cb.type = "checkbox";
      cb.checked = data.strength[bi].sets[s].done;
      const id = `st_${d}_${bi}_${s}`;
      cb.onchange = () => {
        data.strength[bi].sets[s].done = cb.checked;
        saveEntry(p, d, w, data);
        if (cb.checked) awardXPOnce(p, id, 10);
        xpbar.style.width = (100 * currentDone(data, w, d) / total) + "%";
      };
      
      const label = document.createElement('label');
      label.textContent = "Complete";
      label.onclick = () => cb.click();
      
      setItem.appendChild(cb);
      setItem.appendChild(label);
      setContainer.appendChild(setItem);
    }
    str.appendChild(setContainer);
  });
  content.appendChild(str);
  
  notes.value = (data.notes || "");
  notes.oninput = () => {
    data.notes = notes.value;
    saveEntry(p, d, w, data);
  };
}

/* Debounced sync */
function debounce(fn, ms) {
  let t;
  return (...a) => {
    clearTimeout(t);
    t = setTimeout(() => fn(...a), ms);
  };
}
const sendCoachSnapshotDebounced = debounce(sendCoachSnapshot, 350);

/* Initialize */
for (let w = 1; w <= WEEKS; w++) {
  const o = document.createElement('option');
  o.value = w;
  o.textContent = "Week " + w;
  weekSel.appendChild(o);
}

// SET DEFAULT TO WEEK 1
weekSel.value = "1";

daySel.onchange = () => {
  console.log('Day changed to:', daySel.value);
  render();
};

weekSel.onchange = () => {
  console.log('Week changed to:', weekSel.value);
  render();
};

(function firstRun() {
  let p = currentPlayer();
  if (!p) { p = promptForNameOnce(); }
  console.log('Initial render - Week selector value:', weekSel.value);
  render();
})();
</script>
</body></html>
